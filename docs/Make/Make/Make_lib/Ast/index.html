<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ast (Make.Make_lib.Ast)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">Make</a> &#x00BB; <a href="../index.html">Make_lib</a> &#x00BB; Ast</nav><header class="odoc-preamble"><h1>Module <code><span>Make_lib.Ast</span></code></h1><p>Copyright 2021-2022, ol-imorozko and contributors</p></header><div class="odoc-content"><p>SPDX-License-Identifier: LGPL-3.0-or-later</p><div class="odoc-spec"><div class="spec type" id="type-substitute" class="anchored"><a href="#type-substitute" class="anchor"></a><code><span><span class="keyword">type</span> substitute</span><span> = </span></code><table><tr id="type-substitute.Regular" class="anchored"><td class="def variant constructor"><a href="#type-substitute.Regular" class="anchor"></a><code><span>| </span><span><span class="constructor">Regular</span> <span class="keyword">of</span> <span><a href="#type-substitute">substitute</a> <span class="xref-unresolved">Base</span>.list</span></span></code></td></tr><tr id="type-substitute.Pattern" class="anchored"><td class="def variant constructor"><a href="#type-substitute.Pattern" class="anchor"></a><code><span>| </span><span><span class="constructor">Pattern</span></span></code></td></tr><tr id="type-substitute.None" class="anchored"><td class="def variant constructor"><a href="#type-substitute.None" class="anchor"></a><code><span>| </span><span><span class="constructor">None</span> <span class="keyword">of</span> <span class="xref-unresolved">Base</span>.string</span></code></td></tr><tr id="type-substitute.Asterisk" class="anchored"><td class="def variant constructor"><a href="#type-substitute.Asterisk" class="anchor"></a><code><span>| </span><span><span class="constructor">Asterisk</span></span></code></td></tr><tr id="type-substitute.At" class="anchored"><td class="def variant constructor"><a href="#type-substitute.At" class="anchor"></a><code><span>| </span><span><span class="constructor">At</span></span></code></td></tr><tr id="type-substitute.Lesser" class="anchored"><td class="def variant constructor"><a href="#type-substitute.Lesser" class="anchor"></a><code><span>| </span><span><span class="constructor">Lesser</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_substitute" class="anchored"><a href="#val-pp_substitute" class="anchor"></a><code><span><span class="keyword">val</span> pp_substitute : 
  <span><span class="xref-unresolved">Ppx_deriving_runtime</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-substitute">substitute</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_deriving_runtime</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-show_substitute" class="anchored"><a href="#val-show_substitute" class="anchor"></a><code><span><span class="keyword">val</span> show_substitute : <span><a href="#type-substitute">substitute</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_deriving_runtime</span>.string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-regular" class="anchored"><a href="#val-regular" class="anchor"></a><code><span><span class="keyword">val</span> regular : <span><span><a href="#type-substitute">substitute</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-substitute">substitute</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pattern" class="anchored"><a href="#val-pattern" class="anchor"></a><code><span><span class="keyword">val</span> pattern : <a href="#type-substitute">substitute</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-none" class="anchored"><a href="#val-none" class="anchor"></a><code><span><span class="keyword">val</span> none : <span><span class="xref-unresolved">Base</span>.string <span class="arrow">&#45;&gt;</span></span> <a href="#type-substitute">substitute</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-asterisk" class="anchored"><a href="#val-asterisk" class="anchor"></a><code><span><span class="keyword">val</span> asterisk : <a href="#type-substitute">substitute</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-at" class="anchored"><a href="#val-at" class="anchor"></a><code><span><span class="keyword">val</span> at : <a href="#type-substitute">substitute</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-lesser" class="anchored"><a href="#val-lesser" class="anchor"></a><code><span><span class="keyword">val</span> lesser : <a href="#type-substitute">substitute</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Variants_of_substitute" class="anchored"><a href="#module-Variants_of_substitute" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Variants_of_substitute/index.html">Variants_of_substitute</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-substitute_of_sexp" class="anchored"><a href="#val-substitute_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> substitute_of_sexp : <span><span class="xref-unresolved">Base__</span>.Ppx_sexp_conv_lib.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-substitute">substitute</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_substitute" class="anchored"><a href="#val-sexp_of_substitute" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_substitute : <span><a href="#type-substitute">substitute</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base__</span>.Ppx_sexp_conv_lib.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_substitute" class="anchored"><a href="#val-compare_substitute" class="anchor"></a><code><span><span class="keyword">val</span> compare_substitute : <span><a href="#type-substitute">substitute</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-substitute">substitute</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-word" class="anchored"><a href="#type-word" class="anchor"></a><code><span><span class="keyword">type</span> word</span><span> = <span><a href="#type-substitute">substitute</a> <span class="xref-unresolved">Base</span>.list</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_word" class="anchored"><a href="#val-pp_word" class="anchor"></a><code><span><span class="keyword">val</span> pp_word : 
  <span><span class="xref-unresolved">Ppx_deriving_runtime</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_deriving_runtime</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-show_word" class="anchored"><a href="#val-show_word" class="anchor"></a><code><span><span class="keyword">val</span> show_word : <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_deriving_runtime</span>.string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-word_of_sexp" class="anchored"><a href="#val-word_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> word_of_sexp : <span><span class="xref-unresolved">Ppx_sexp_conv_lib</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-word">word</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_word" class="anchored"><a href="#val-sexp_of_word" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_word : <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_sexp_conv_lib</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_word" class="anchored"><a href="#val-compare_word" class="anchor"></a><code><span><span class="keyword">val</span> compare_word : <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Base</span>.int</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-var" class="anchored"><a href="#type-var" class="anchor"></a><code><span><span class="keyword">type</span> var</span><span> = </span></code><table><tr id="type-var.Recursive" class="anchored"><td class="def variant constructor"><a href="#type-var.Recursive" class="anchor"></a><code><span>| </span><span><span class="constructor">Recursive</span> <span class="keyword">of</span> <a href="#type-word">word</a> * <span><a href="#type-word">word</a> <span class="xref-unresolved">Base</span>.list</span></span></code></td></tr><tr id="type-var.Simply" class="anchored"><td class="def variant constructor"><a href="#type-var.Simply" class="anchor"></a><code><span>| </span><span><span class="constructor">Simply</span> <span class="keyword">of</span> <a href="#type-word">word</a> * <span><a href="#type-word">word</a> <span class="xref-unresolved">Base</span>.list</span></span></code></td></tr><tr id="type-var.Conditional" class="anchored"><td class="def variant constructor"><a href="#type-var.Conditional" class="anchor"></a><code><span>| </span><span><span class="constructor">Conditional</span> <span class="keyword">of</span> <a href="#type-word">word</a> * <span><a href="#type-word">word</a> <span class="xref-unresolved">Base</span>.list</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_var" class="anchored"><a href="#val-pp_var" class="anchor"></a><code><span><span class="keyword">val</span> pp_var : 
  <span><span class="xref-unresolved">Ppx_deriving_runtime</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-var">var</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_deriving_runtime</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-show_var" class="anchored"><a href="#val-show_var" class="anchor"></a><code><span><span class="keyword">val</span> show_var : <span><a href="#type-var">var</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_deriving_runtime</span>.string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-recursive" class="anchored"><a href="#val-recursive" class="anchor"></a><code><span><span class="keyword">val</span> recursive : <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-word">word</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-var">var</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-simply" class="anchored"><a href="#val-simply" class="anchor"></a><code><span><span class="keyword">val</span> simply : <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-word">word</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-var">var</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-conditional" class="anchored"><a href="#val-conditional" class="anchor"></a><code><span><span class="keyword">val</span> conditional : <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-word">word</a> <span class="xref-unresolved">Base</span>.list</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-var">var</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Variants_of_var" class="anchored"><a href="#module-Variants_of_var" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Variants_of_var/index.html">Variants_of_var</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-recipe" class="anchored"><a href="#type-recipe" class="anchor"></a><code><span><span class="keyword">type</span> recipe</span><span> = </span></code><table><tr id="type-recipe.Echo" class="anchored"><td class="def variant constructor"><a href="#type-recipe.Echo" class="anchor"></a><code><span>| </span><span><span class="constructor">Echo</span> <span class="keyword">of</span> <a href="#type-word">word</a></span></code></td></tr><tr id="type-recipe.Silent" class="anchored"><td class="def variant constructor"><a href="#type-recipe.Silent" class="anchor"></a><code><span>| </span><span><span class="constructor">Silent</span> <span class="keyword">of</span> <a href="#type-word">word</a></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_recipe" class="anchored"><a href="#val-pp_recipe" class="anchor"></a><code><span><span class="keyword">val</span> pp_recipe : 
  <span><span class="xref-unresolved">Ppx_deriving_runtime</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-recipe">recipe</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_deriving_runtime</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-show_recipe" class="anchored"><a href="#val-show_recipe" class="anchor"></a><code><span><span class="keyword">val</span> show_recipe : <span><a href="#type-recipe">recipe</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_deriving_runtime</span>.string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-echo" class="anchored"><a href="#val-echo" class="anchor"></a><code><span><span class="keyword">val</span> echo : <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-recipe">recipe</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-silent" class="anchored"><a href="#val-silent" class="anchor"></a><code><span><span class="keyword">val</span> silent : <span><a href="#type-word">word</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-recipe">recipe</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Variants_of_recipe" class="anchored"><a href="#module-Variants_of_recipe" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Variants_of_recipe/index.html">Variants_of_recipe</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-recipe_of_sexp" class="anchored"><a href="#val-recipe_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> recipe_of_sexp : <span><span class="xref-unresolved">Ppx_sexp_conv_lib</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-recipe">recipe</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_recipe" class="anchored"><a href="#val-sexp_of_recipe" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_recipe : <span><a href="#type-recipe">recipe</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_sexp_conv_lib</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-rule" class="anchored"><a href="#type-rule" class="anchor"></a><code><span><span class="keyword">type</span> rule</span><span> = </span><span>{</span></code><table><tr id="type-rule.targets" class="anchored"><td class="def record field"><a href="#type-rule.targets" class="anchor"></a><code><span>targets : <a href="#type-word">word</a> * <span><a href="#type-word">word</a> <span class="xref-unresolved">Base</span>.list</span>;</span></code></td></tr><tr id="type-rule.prerequisites" class="anchored"><td class="def record field"><a href="#type-rule.prerequisites" class="anchor"></a><code><span>prerequisites : <span><a href="#type-word">word</a> <span class="xref-unresolved">Base</span>.list</span>;</span></code></td></tr><tr id="type-rule.recipes" class="anchored"><td class="def record field"><a href="#type-rule.recipes" class="anchor"></a><code><span>recipes : <span><a href="#type-recipe">recipe</a> <span class="xref-unresolved">Base</span>.list</span>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_rule" class="anchored"><a href="#val-pp_rule" class="anchor"></a><code><span><span class="keyword">val</span> pp_rule : 
  <span><span class="xref-unresolved">Ppx_deriving_runtime</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-rule">rule</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_deriving_runtime</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-show_rule" class="anchored"><a href="#val-show_rule" class="anchor"></a><code><span><span class="keyword">val</span> show_rule : <span><a href="#type-rule">rule</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_deriving_runtime</span>.string</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-expr" class="anchored"><a href="#type-expr" class="anchor"></a><code><span><span class="keyword">type</span> expr</span><span> = </span></code><table><tr id="type-expr.Rule" class="anchored"><td class="def variant constructor"><a href="#type-expr.Rule" class="anchor"></a><code><span>| </span><span><span class="constructor">Rule</span> <span class="keyword">of</span> <a href="#type-rule">rule</a></span></code></td></tr><tr id="type-expr.Var" class="anchored"><td class="def variant constructor"><a href="#type-expr.Var" class="anchor"></a><code><span>| </span><span><span class="constructor">Var</span> <span class="keyword">of</span> <a href="#type-var">var</a></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_expr" class="anchored"><a href="#val-pp_expr" class="anchor"></a><code><span><span class="keyword">val</span> pp_expr : 
  <span><span class="xref-unresolved">Ppx_deriving_runtime</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-expr">expr</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_deriving_runtime</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-show_expr" class="anchored"><a href="#val-show_expr" class="anchor"></a><code><span><span class="keyword">val</span> show_expr : <span><a href="#type-expr">expr</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_deriving_runtime</span>.string</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-ast" class="anchored"><a href="#type-ast" class="anchor"></a><code><span><span class="keyword">type</span> ast</span><span> = <span>(<a href="#type-rule">rule</a> * <span class="xref-unresolved">Base</span>.int)</span> * <span><a href="#type-expr">expr</a> <span class="xref-unresolved">Base</span>.list</span></span></code></div><div class="spec-doc"><p>Ast for the Make syntax</p><p>Makefile, essentially, is an expr list. However, is should contain at least one rule. We're ensure it by extracting that rule from the list. But we need to remember it's position in the list as this is important when this rule contains a substitute variable.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_ast" class="anchored"><a href="#val-pp_ast" class="anchor"></a><code><span><span class="keyword">val</span> pp_ast : 
  <span><span class="xref-unresolved">Ppx_deriving_runtime</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-ast">ast</a> <span class="arrow">&#45;&gt;</span></span>
  <span class="xref-unresolved">Ppx_deriving_runtime</span>.unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-show_ast" class="anchored"><a href="#val-show_ast" class="anchor"></a><code><span><span class="keyword">val</span> show_ast : <span><a href="#type-ast">ast</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_deriving_runtime</span>.string</span></code></div></div></div></body></html>